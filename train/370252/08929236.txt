In an example network_flow_analysis__sample_packets can be received from a stream of packets over a time_interval from a network_element. The sample_packets can be aggregated into a subclass of packets. A sample_pool_size of the stream of packets in the time_interval  a number of sample_packets_received over the time_interval  and a number of sample_packets_aggregated into the subclass of packets can be determined. An effective sampling ratio  ESR  from the sample_pool_size of the stream of packets in the time_interval and the number of sample_packets_received over the time_interval can be calculated. An extrapolated_flow for the subclass of sample_packets can be calculated by multiplying the ESR by the number of sample_packets_aggregated into the subclass of packets.