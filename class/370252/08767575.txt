A digital_apparatus_comprising a fast Fourier transform  FFT  module configured to transform a time_domain_optical_signal into a frequency_domain_optical_signal  a circular_shifter_coupled to the FFT module and configured to provide_coarse_frequency_offset_compensation to the frequency_domain_optical_signal_based on an estimated_frequency_offset  and a frequency_offset_estimation_module_coupled to the circular_shifter and configured to provide the estimated_frequency_offset_based on a power_spectrum of the frequency_domain_optical_signal or a data_block_header_autocorrelation of the time_domain_optical_signal.